<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets API Example 2</title>
</head>

<body>
    <h1>Google Sheets API Example</h1>

    <!-- Include the Google API Client Library -->
    <script src="https://apis.google.com/js/api.js"></script>

    <script>
        function initClient() {
  // Assuming you have already loaded the Google API client library
  gapi.client.init({
    apiKey: null,
    clientId: '919283499456-q0t98tkue813rh80jev0em0jk8k2t3ae.apps.googleusercontent.com',  // Updated with your client ID
    discoveryDocs: ["https://sheets.googleapis.com/$discovery/rest?version=v4"],
  }).then(function () {
    // Use OAuth 2.0 client credentials
    gapi.auth2.authorize({
      client_id: '919283499456-q0t98tkue813rh80jev0em0jk8k2t3ae.apps.googleusercontent.com',
      scope: 'https://www.googleapis.com/auth/spreadsheets',
      immediate: false
    }, function (authResult) {
      console.log(authResult);
      if (authResult && !authResult.error) {
        // Call the Google Sheets API
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '10qRn3I9GdzEIiCuwhJgo2JAOQScZZHRc',
          range: 'Progress', // Replace with your sheet name or range
        }).then(function (response) {
          var values = response.result.values;
          // Process the data as needed
          console.log(values);
        }).catch(function (error) {
          console.error('Error calling Google Sheets API:', error);
        });
      } else {
        console.error('Error authorizing with OAuth 2.0 client credentials:', authResult.error);
      }
    });
  }).catch(function (error) {
    console.error('Error initializing the Google Sheets API:', error);
  });
}


        // Load the Google API client and the Sheets API
        //gapi.load('client', initClient);
    </script>

    <!-- Add a button to trigger the API call (optional) -->
    <button onclick="initClient()">Get Spreadsheet Data</button>
</body>

</html>
